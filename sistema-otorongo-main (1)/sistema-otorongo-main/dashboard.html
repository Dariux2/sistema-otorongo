<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Centro Oftalmológico El Otorongo</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="dashboard-page">
    <!-- Header del Dashboard -->
    <header class="dashboard-header-main">
        <div class="container">
            <div class="dashboard-brand">
                <i class="fas fa-eye"></i>
                <h1>Centro Oftalmológico El Otorongo</h1>
            </div>
            
            <div class="dashboard-user-info">
                <div class="user-welcome">
                    <span class="user-greeting">Bienvenido,</span>
                    <span class="user-name" id="userName">Usuario</span>
                    <span class="user-role" id="userRole">Rol</span>
                </div>
                <div class="user-actions">
                    <button class="btn-notification" onclick="showNotifications()">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notificationCount">3</span>
                    </button>
                    <button class="btn-profile" onclick="showProfile()">
                        <i class="fas fa-user-circle"></i>
                    </button>
                    <button class="btn-logout" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Salir</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navegación Principal -->
    <nav class="dashboard-nav">
        <div class="container">
            <ul class="nav-menu" id="dashboardMenu">
                <!-- El menú se carga dinámicamente según el rol -->
            </ul>
        </div>
    </nav>

    <!-- Contenido Principal -->
    <main class="dashboard-main">
        <div class="container">
            <!-- Sección de Estadísticas -->
            <section class="dashboard-stats">
                <div class="stats-grid" id="statsGrid">
                    <!-- Las estadísticas se cargan dinámicamente -->
                </div>
            </section>

            <!-- Sección de Contenido Dinámico -->
            <section class="dashboard-content">
                <div class="content-grid">
                    <!-- Panel de Citas del Día -->
                    <div class="content-panel" id="todayAppointments">
                        <div class="panel-header">
                            <h3><i class="fas fa-calendar-day"></i> Citas de Hoy</h3>
                            <button class="btn-panel-action" onclick="loadPage('citas')">
                                <i class="fas fa-plus"></i> Nueva Cita
                            </button>
                        </div>
                        <div class="panel-content">
                            <div class="appointments-list" id="todayAppointmentsList">
                                <!-- Lista de citas se carga dinámicamente -->
                            </div>
                        </div>
                    </div>

                    <!-- Panel de Pacientes Recientes -->
                    <div class="content-panel" id="recentPatients">
                        <div class="panel-header">
                            <h3><i class="fas fa-users"></i> Pacientes Recientes</h3>
                            <button class="btn-panel-action" onclick="loadPage('pacientes')">
                                <i class="fas fa-user-plus"></i> Nuevo Paciente
                            </button>
                        </div>
                        <div class="panel-content">
                            <div class="patients-list" id="recentPatientsList">
                                <!-- Lista de pacientes se carga dinámicamente -->
                            </div>
                        </div>
                    </div>

                    <!-- Panel de Actividad Reciente -->
                    <div class="content-panel full-width" id="recentActivity">
                        <div class="panel-header">
                            <h3><i class="fas fa-history"></i> Actividad Reciente</h3>
                            <button class="btn-panel-action" onclick="refreshActivity()">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                        <div class="panel-content">
                            <div class="activity-timeline" id="activityTimeline">
                                <!-- Timeline de actividad se carga dinámicamente -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Modal de Notificaciones -->
    <div id="notificationsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-bell"></i> Notificaciones
                </h3>
                <button class="modal-close" onclick="closeModal('notificationsModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="notifications-list" id="notificationsList">
                    <!-- Lista de notificaciones -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Perfil -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-user"></i> Mi Perfil
                </h3>
                <button class="modal-close" onclick="closeModal('profileModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="profile-info" id="profileInfo">
                    <!-- Información del perfil -->
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Variables del dashboard
        let currentUser = null;
        let dashboardData = {};

        // Inicializar dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
        });

        // Inicializar dashboard
        function initializeDashboard() {
            // Verificar autenticación
            if (!checkAuthentication()) {
                return;
            }

            // Cargar datos del usuario
            loadUserData();
            
            // Configurar menú según rol
            setupRoleBasedMenu();
            
            // Cargar estadísticas
            loadDashboardStats();
            
            // Cargar contenido inicial
            loadDashboardContent();
            
            // Configurar actualizaciones automáticas
            setupAutoRefresh();
        }

        // Verificar autenticación
        function checkAuthentication() {
            const savedUser = localStorage.getItem('otorongo_current_user');
            
            if (!savedUser) {
                showNotification('Sesión expirada. Redirigiendo al login...', 'warning');
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 2000);
                return false;
            }
            
            currentUser = JSON.parse(savedUser);
            return true;
        }

        // Cargar datos del usuario
        function loadUserData() {
            if (!currentUser) return;
            
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userRole').textContent = getRoleDisplayName(currentUser.role);
            
            // Actualizar título de la página
            document.title = `Dashboard ${getRoleDisplayName(currentUser.role)} - Centro Oftalmológico El Otorongo`;
        }

        // Obtener nombre de rol para mostrar
        function getRoleDisplayName(role) {
            const roleNames = {
                'administrador': 'Administrador',
                'medico': 'Médico',
                'recepcionista': 'Recepcionista'
            };
            return roleNames[role] || role;
        }

        // Configurar menú según rol
        function setupRoleBasedMenu() {
            const menuContainer = document.getElementById('dashboardMenu');
            const menus = {
                'administrador': [
                    { icon: 'fas fa-tachometer-alt', text: 'Dashboard', page: 'dashboard', active: true },
                    { icon: 'fas fa-users', text: 'Pacientes', page: 'pacientes' },
                    { icon: 'fas fa-calendar-alt', text: 'Citas', page: 'citas' },
                    { icon: 'fas fa-file-invoice-dollar', text: 'Facturación', page: 'facturacion' },
                    { icon: 'fas fa-chart-bar', text: 'Reportes', page: 'reportes' },
                    { icon: 'fas fa-user-md', text: 'Personal', page: 'personal' },
                    { icon: 'fas fa-cog', text: 'Configuración', page: 'configuracion' }
                ],
                'medico': [
                    { icon: 'fas fa-tachometer-alt', text: 'Dashboard', page: 'dashboard', active: true },
                    { icon: 'fas fa-users', text: 'Mis Pacientes', page: 'pacientes' },
                    { icon: 'fas fa-calendar-alt', text: 'Mis Citas', page: 'citas' },
                    { icon: 'fas fa-notes-medical', text: 'Historiales', page: 'historiales' },
                    { icon: 'fas fa-chart-line', text: 'Mis Reportes', page: 'reportes' }
                ],
                'recepcionista': [
                    { icon: 'fas fa-tachometer-alt', text: 'Dashboard', page: 'dashboard', active: true },
                    { icon: 'fas fa-users', text: 'Pacientes', page: 'pacientes' },
                    { icon: 'fas fa-calendar-alt', text: 'Citas', page: 'citas' },
                    { icon: 'fas fa-file-invoice', text: 'Facturación', page: 'facturacion' },
                    { icon: 'fas fa-phone', text: 'Contactos', page: 'contactos' }
                ]
            };

            const userMenu = menus[currentUser.role] || menus['recepcionista'];
            
            menuContainer.innerHTML = userMenu.map(item => `
                <li>
                    <a href="#" class="nav-item ${item.active ? 'active' : ''}" 
                       onclick="loadPage('${item.page}')" data-page="${item.page}">
                        <i class="${item.icon}"></i>
                        <span>${item.text}</span>
                    </a>
                </li>
            `).join('');
        }

        // Cargar estadísticas del dashboard
        function loadDashboardStats() {
            const patients = OtorongoSystem.getPatients();
            const appointments = OtorongoSystem.getAppointments();
            const invoices = OtorongoSystem.getInvoices();
            
            // Calcular estadísticas
            const today = new Date().toISOString().split('T')[0];
            const todayAppointments = appointments.filter(apt => apt.fecha === today);
            const pendingAppointments = appointments.filter(apt => apt.estado === 'programada');
            const totalRevenue = invoices.reduce((sum, inv) => sum + inv.total, 0);
            const paidInvoices = invoices.filter(inv => inv.estado === 'pagada');

            const stats = [
                {
                    icon: 'fas fa-users',
                    title: 'Total Pacientes',
                    value: patients.length,
                    color: 'primary',
                    trend: '+5%'
                },
                {
                    icon: 'fas fa-calendar-check',
                    title: 'Citas Hoy',
                    value: todayAppointments.length,
                    color: 'success',
                    trend: '+12%'
                },
                {
                    icon: 'fas fa-clock',
                    title: 'Citas Pendientes',
                    value: pendingAppointments.length,
                    color: 'warning',
                    trend: '-3%'
                },
                {
                    icon: 'fas fa-dollar-sign',
                    title: 'Ingresos del Mes',
                    value: OtorongoSystem.formatCurrency(totalRevenue),
                    color: 'info',
                    trend: '+8%'
                }
            ];

            // Filtrar estadísticas según rol
            let filteredStats = stats;
            if (currentUser.role === 'medico') {
                // Solo mostrar estadísticas relevantes para médicos
                filteredStats = stats.slice(0, 3);
            } else if (currentUser.role === 'recepcionista') {
                // Estadísticas relevantes para recepcionistas
                filteredStats = [stats[0], stats[1], stats[2]];
            }

            const statsContainer = document.getElementById('statsGrid');
            statsContainer.innerHTML = filteredStats.map(stat => `
                <div class="stat-card ${stat.color}">
                    <div class="stat-icon">
                        <i class="${stat.icon}"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number">${stat.value}</div>
                        <div class="stat-label">${stat.title}</div>
                        <div class="stat-trend ${stat.trend.startsWith('+') ? 'positive' : 'negative'}">
                            <i class="fas fa-arrow-${stat.trend.startsWith('+') ? 'up' : 'down'}"></i>
                            ${stat.trend}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Cargar contenido del dashboard
        function loadDashboardContent() {
            loadTodayAppointments();
            loadRecentPatients();
            loadRecentActivity();
        }

        // Cargar citas de hoy
        function loadTodayAppointments() {
            const appointments = OtorongoSystem.getAppointments();
            const patients = OtorongoSystem.getPatients();
            const today = new Date().toISOString().split('T')[0];
            
            let todayAppointments = appointments.filter(apt => apt.fecha === today);
            
            // Filtrar por médico si es necesario
            if (currentUser.role === 'medico') {
                todayAppointments = todayAppointments.filter(apt => apt.medico === currentUser.name);
            }

            const container = document.getElementById('todayAppointmentsList');
            
            if (todayAppointments.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calendar-times"></i>
                        <p>No hay citas programadas para hoy</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = todayAppointments.map(appointment => {
                const patient = patients.find(p => p.id === appointment.pacienteId);
                const patientName = patient ? `${patient.nombres} ${patient.apellidos}` : 'Paciente no encontrado';
                
                return `
                    <div class="appointment-item">
                        <div class="appointment-time">
                            <i class="fas fa-clock"></i>
                            ${OtorongoSystem.formatTime(appointment.hora)}
                        </div>
                        <div class="appointment-details">
                            <div class="appointment-patient">${patientName}</div>
                            <div class="appointment-type">${appointment.tipo}</div>
                            <div class="appointment-doctor">
                                <i class="fas fa-user-md"></i>
                                ${appointment.medico}
                            </div>
                        </div>
                        <div class="appointment-status">
                            <span class="badge ${appointment.estado}">${appointment.estado}</span>
                        </div>
                        <div class="appointment-actions">
                            <button class="btn-action" onclick="viewAppointment('${appointment.id}')" title="Ver detalles">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Cargar pacientes recientes
        function loadRecentPatients() {
            const patients = OtorongoSystem.getPatients();
            const recentPatients = patients
                .sort((a, b) => new Date(b.fechaRegistro) - new Date(a.fechaRegistro))
                .slice(0, 5);

            const container = document.getElementById('recentPatientsList');
            
            if (recentPatients.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-user-times"></i>
                        <p>No hay pacientes registrados</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = recentPatients.map(patient => `
                <div class="patient-item">
                    <div class="patient-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="patient-details">
                        <div class="patient-name">${patient.nombres} ${patient.apellidos}</div>
                        <div class="patient-info">
                            <span class="patient-dni">DNI: ${patient.dni}</span>
                            <span class="patient-phone">
                                <i class="fas fa-phone"></i>
                                ${patient.telefono}
                            </span>
                        </div>
                        <div class="patient-date">
                            Registrado: ${OtorongoSystem.formatDate(patient.fechaRegistro)}
                        </div>
                    </div>
                    <div class="patient-actions">
                        <button class="btn-action" onclick="viewPatient('${patient.id}')" title="Ver perfil">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Cargar actividad reciente
        function loadRecentActivity() {
            // Simular actividad reciente
            const activities = [
                {
                    type: 'appointment',
                    icon: 'fas fa-calendar-plus',
                    title: 'Nueva cita programada',
                    description: 'Cita para Juan Pérez - Consulta General',
                    time: '2 horas atrás',
                    color: 'success'
                },
                {
                    type: 'patient',
                    icon: 'fas fa-user-plus',
                    title: 'Nuevo paciente registrado',
                    description: 'María Rodríguez se registró en el sistema',
                    time: '4 horas atrás',
                    color: 'info'
                },
                {
                    type: 'payment',
                    icon: 'fas fa-dollar-sign',
                    title: 'Pago recibido',
                    description: 'Factura #001 pagada - S/. 94.40',
                    time: '6 horas atrás',
                    color: 'primary'
                },
                {
                    type: 'appointment',
                    icon: 'fas fa-calendar-check',
                    title: 'Cita completada',
                    description: 'Consulta de control - Dr. Carlos Mendoza',
                    time: '1 día atrás',
                    color: 'success'
                }
            ];

            const container = document.getElementById('activityTimeline');
            container.innerHTML = activities.map(activity => `
                <div class="activity-item">
                    <div class="activity-icon ${activity.color}">
                        <i class="${activity.icon}"></i>
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">${activity.title}</div>
                        <div class="activity-description">${activity.description}</div>
                        <div class="activity-time">
                            <i class="fas fa-clock"></i>
                            ${activity.time}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Configurar actualización automática
        function setupAutoRefresh() {
            // Actualizar cada 5 minutos
            setInterval(() => {
                loadDashboardStats();
                loadTodayAppointments();
            }, 300000);
        }

        // Cargar página específica
        function loadPage(page) {
            // Actualizar navegación activa
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeItem = document.querySelector(`[data-page="${page}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }

            // Redirigir a la página específica
            const pages = {
                'dashboard': 'dashboard.html',
                'pacientes': 'pacientes.html',
                'citas': 'citas.html',
                'facturacion': 'facturacion.html',
                'reportes': 'reportes.html',
                'personal': 'personal.html',
                'configuracion': 'configuracion.html',
                'historiales': 'historiales.html',
                'contactos': 'contactos.html'
            };

            if (pages[page] && page !== 'dashboard') {
                window.location.href = pages[page];
            }
        }

        // Mostrar notificaciones
        function showNotifications() {
            const notifications = [
                {
                    id: 1,
                    type: 'appointment',
                    title: 'Cita próxima',
                    message: 'Cita con Juan Pérez en 30 minutos',
                    time: '5 min',
                    read: false
                },
                {
                    id: 2,
                    type: 'payment',
                    title: 'Pago pendiente',
                    message: 'Factura #002 pendiente de pago',
                    time: '1 hora',
                    read: false
                },
                {
                    id: 3,
                    type: 'system',
                    title: 'Actualización del sistema',
                    message: 'Nueva versión disponible',
                    time: '2 horas',
                    read: true
                }
            ];

            const container = document.getElementById('notificationsList');
            container.innerHTML = notifications.map(notification => `
                <div class="notification-item ${notification.read ? 'read' : 'unread'}">
                    <div class="notification-icon ${notification.type}">
                        <i class="fas fa-${getNotificationIcon(notification.type)}"></i>
                    </div>
                    <div class="notification-content">
                        <div class="notification-title">${notification.title}</div>
                        <div class="notification-message">${notification.message}</div>
                        <div class="notification-time">${notification.time}</div>
                    </div>
                    <div class="notification-actions">
                        <button class="btn-mark-read" onclick="markAsRead(${notification.id})">
                            <i class="fas fa-check"></i>
                        </button>
                    </div>
                </div>
            `).join('');

            openModal('notificationsModal');
        }

        function getNotificationIcon(type) {
            const icons = {
                'appointment': 'calendar',
                'payment': 'dollar-sign',
                'system': 'cog',
                'patient': 'user'
            };
            return icons[type] || 'bell';
        }

        // Mostrar perfil
        function showProfile() {
            const profileContainer = document.getElementById('profileInfo');
            profileContainer.innerHTML = `
                <div class="profile-header">
                    <div class="profile-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="profile-details">
                        <h3>${currentUser.name}</h3>
                        <p class="profile-role">${getRoleDisplayName(currentUser.role)}</p>
                        <p class="profile-email">${currentUser.email}</p>
                    </div>
                </div>
                
                <div class="profile-info-grid">
                    <div class="info-item">
                        <label>Usuario:</label>
                        <span>${currentUser.username}</span>
                    </div>
                    <div class="info-item">
                        <label>Rol:</label>
                        <span>${getRoleDisplayName(currentUser.role)}</span>
                    </div>
                    <div class="info-item">
                        <label>Email:</label>
                        <span>${currentUser.email}</span>
                    </div>
                    <div class="info-item">
                        <label>Última sesión:</label>
                        <span>${OtorongoSystem.formatDate(localStorage.getItem('otorongo_login_time'))}</span>
                    </div>
                </div>
                
                <div class="profile-actions">
                    <button class="btn-primary" onclick="changePassword()">
                        <i class="fas fa-key"></i> Cambiar Contraseña
                    </button>
                    <button class="btn-secondary" onclick="editProfile()">
                        <i class="fas fa-edit"></i> Editar Perfil
                    </button>
                </div>
            `;

            openModal('profileModal');
        }

        // Funciones de acción
        function viewAppointment(appointmentId) {
            showNotification('Función de ver cita en desarrollo', 'info');
        }

        function viewPatient(patientId) {
            showNotification('Función de ver paciente en desarrollo', 'info');
        }

        function refreshActivity() {
            loadRecentActivity();
            showNotification('Actividad actualizada', 'success');
        }

        function markAsRead(notificationId) {
            showNotification('Notificación marcada como leída', 'success');
            // Actualizar contador
            const badge = document.getElementById('notificationCount');
            const currentCount = parseInt(badge.textContent);
            if (currentCount > 0) {
                badge.textContent = currentCount - 1;
            }
        }

        function changePassword() {
            showNotification('Función de cambio de contraseña en desarrollo', 'info');
        }

        function editProfile() {
            showNotification('Función de editar perfil en desarrollo', 'info');
        }

        // Cerrar sesión
        function logout() {
            if (confirm('¿Está seguro que desea cerrar sesión?')) {
                localStorage.removeItem('otorongo_current_user');
                localStorage.removeItem('otorongo_login_time');
                showNotification('Sesión cerrada correctamente', 'success');
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1500);
            }
        }
    </script>

    <style>
        /* Estilos específicos del dashboard */
        .dashboard-page {
            background-color: var(--gray-100);
        }

        .dashboard-header-main {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--white);
            padding: 1rem 0;
            box-shadow: var(--box-shadow);
        }

        .dashboard-header-main .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dashboard-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .dashboard-brand i {
            font-size: 2rem;
        }

        .dashboard-brand h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .dashboard-user-info {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .user-welcome {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .user-greeting {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .user-name {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .user-role {
            font-size: 0.85rem;
            opacity: 0.7;
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .btn-notification,
        .btn-profile,
        .btn-logout {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--white);
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-notification {
            position: relative;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger-color);
            color: var(--white);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-notification:hover,
        .btn-profile:hover,
        .btn-logout:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .dashboard-nav {
            background: var(--white);
            box-shadow: var(--box-shadow);
            margin-bottom: 2rem;
        }

        .nav-menu {
            list-style: none;
            display: flex;
            gap: 0;
            margin: 0;
            padding: 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 1.5rem;
            color: var(--gray-700);
            text-decoration: none;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .nav-item:hover,
        .nav-item.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background-color: var(--gray-50);
        }

        .dashboard-main {
            padding: 0 0 2rem;
        }

        .dashboard-stats {
            margin-bottom: 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .stat-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--box-shadow);
            display: flex;
            align-items: center;
            gap: 1rem;
            border-left: 4px solid var(--primary-color);
        }

        .stat-card.success {
            border-left-color: var(--success-color);
        }

        .stat-card.warning {
            border-left-color: var(--warning-color);
        }

        .stat-card.info {
            border-left-color: var(--accent-color);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--white);
            background: var(--primary-color);
        }

        .stat-card.success .stat-icon {
            background: var(--success-color);
        }

        .stat-card.warning .stat-icon {
            background: var(--warning-color);
        }

        .stat-card.info .stat-icon {
            background: var(--accent-color);
        }

        .stat-content {
            flex: 1;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--gray-600);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .stat-trend {
            font-size: 0.875rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .stat-trend.positive {
            color: var(--success-color);
        }

        .stat-trend.negative {
            color: var(--danger-color);
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .content-panel {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }

        .content-panel.full-width {
            grid-column: 1 / -1;
        }

        .panel-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--gray-50);
        }

        .panel-header h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-panel-action {
            background: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
        }

        .btn-panel-action:hover {
            background: #1e3d6f;
        }

        .panel-content {
            padding: 1.5rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .empty-state {
            text-align: center;
            padding: 2rem;
            color: var(--gray-500);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .appointment-item,
        .patient-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: 1px solid var(--gray-200);
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            transition: var(--transition);
        }

        .appointment-item:hover,
        .patient-item:hover {
            box-shadow: var(--box-shadow);
            border-color: var(--primary-color);
        }

        .appointment-time {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            color: var(--primary-color);
            min-width: 100px;
        }

        .appointment-details {
            flex: 1;
        }

        .appointment-patient {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.25rem;
        }

        .appointment-type {
            color: var(--gray-600);
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .appointment-doctor {
            color: var(--gray-500);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .appointment-status .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge.programada {
            background: var(--warning-color);
            color: var(--gray-800);
        }

        .badge.completada {
            background: var(--success-color);
            color: var(--white);
        }

        .badge.cancelada {
            background: var(--danger-color);
            color: var(--white);
        }

        .appointment-actions,
        .patient-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-action {
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            color: var(--gray-600);
            padding: 0.5rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-action:hover {
            background: var(--primary-color);
            color: var(--white);
            border-color: var(--primary-color);
        }

        .patient-avatar {
            width: 50px;
            height: 50px;
            background: var(--gray-200);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-500);
            font-size: 1.5rem;
        }

        .patient-details {
            flex: 1;
        }

        .patient-name {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.25rem;
        }

        .patient-info {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.25rem;
        }

        .patient-dni,
        .patient-phone {
            color: var(--gray-600);
            font-size: 0.9rem;
        }

        .patient-phone {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .patient-date {
            color: var(--gray-500);
            font-size: 0.85rem;
        }

        .activity-timeline {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            border: 1px solid var(--gray-200);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .activity-item:hover {
            box-shadow: var(--box-shadow);
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1rem;
            flex-shrink: 0;
        }

        .activity-icon.success {
            background: var(--success-color);
        }

        .activity-icon.info {
            background: var(--accent-color);
        }

        .activity-icon.primary {
            background: var(--primary-color);
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.25rem;
        }

        .activity-description {
            color: var(--gray-600);
            margin-bottom: 0.5rem;
        }

        .activity-time {
            color: var(--gray-500);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .notifications-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .notification-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            border: 1px solid var(--gray-200);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .notification-item.unread {
            background: var(--gray-50);
            border-left: 4px solid var(--primary-color);
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1rem;
            flex-shrink: 0;
        }

        .notification-icon.appointment {
            background: var(--success-color);
        }

        .notification-icon.payment {
            background: var(--warning-color);
        }

        .notification-icon.system {
            background: var(--gray-500);
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.25rem;
        }

        .notification-message {
            color: var(--gray-600);
            margin-bottom: 0.5rem;
        }

        .notification-time {
            color: var(--gray-500);
            font-size: 0.85rem;
        }

        .notification-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-mark-read {
            background: var(--success-color);
            color: var(--white);
            border: none;
            padding: 0.25rem 0.5rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 0.75rem;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray-200);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            background: var(--primary-color);
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .profile-details h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.25rem;
        }

        .profile-role {
            color: var(--primary-color);
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .profile-email {
            color: var(--gray-600);
        }

        .profile-info-grid {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: var(--gray-50);
            border-radius: var(--border-radius);
        }

        .info-item label {
            font-weight: 600;
            color: var(--dark-color);
        }

        .info-item span {
            color: var(--gray-600);
        }

        .profile-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-header-main .container {
                flex-direction: column;
                gap: 1rem;
            }

            .dashboard-user-info {
                width: 100%;
                justify-content: space-between;
            }

            .nav-menu {
                flex-wrap: wrap;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .content-grid {
                grid-template-columns: 1fr;
            }

            .user-actions {
                gap: 0.5rem;
            }

            .btn-logout span {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .dashboard-brand h1 {
                font-size: 1.2rem;
            }

            .user-welcome {
                display: none;
            }

            .panel-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .appointment-item,
            .patient-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
            }

            .appointment-actions,
            .patient-actions {
                width: 100%;
                justify-content: flex-end;
            }
        }
